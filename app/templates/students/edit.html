{% extends 'base.html' %}
{% block title %}Edit {{ student.full_name }} ‚Äî MTB School{% endblock %}
{% block content %}
<div class="content-wrapper">
    <div class="page-header">
        <div>
            <h1 class="page-title">Edit Student</h1>
            <p class="page-subtitle"><span class="reg-no">{{ student.reg_no }}</span> ‚Äî {{ student.full_name }}</p>
        </div>
        <a href="{{ url_for('students.view_student', id=student.id) }}" class="btn btn-outline">‚Üê Back</a>
    </div>

    <form method="POST" action="{{ url_for('students.edit_student', id=student.id) }}" enctype="multipart/form-data">
        <div class="grid-2">
            <div>
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">üìã Personal Information</div>
                    </div>
                    <div class="card-body">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Full Name</label>
                                <input type="text" name="full_name" class="form-control" value="{{ student.full_name }}"
                                    required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Father's Name</label>
                                <input type="text" name="father_name" class="form-control"
                                    value="{{ student.father_name or '' }}">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Gender</label>
                                <select name="gender" class="form-control">
                                    {% for g in ['Male','Female','Other'] %}
                                    <option value="{{ g }}" {% if student.gender==g %}selected{% endif %}>{{ g }}
                                    </option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Blood Group</label>
                                <select name="blood_group" class="form-control">
                                    {% for bg in ['A+','A-','B+','B-','AB+','AB-','O+','O-'] %}
                                    <option value="{{ bg }}" {% if student.blood_group==bg %}selected{% endif %}>{{ bg
                                        }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Phone</label>
                                <input type="text" name="phone" class="form-control" value="{{ student.phone or '' }}">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Parent Phone</label>
                                <input type="text" name="parent_phone" class="form-control"
                                    value="{{ student.parent_phone or '' }}">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Address</label>
                            <textarea name="address" class="form-control"
                                rows="2">{{ student.address or '' }}</textarea>
                        </div>
                    </div>
                </div>
            </div>
            <div>
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">üè´ Academic & Status</div>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <label class="form-label">Class / Section</label>
                            <select name="class_section_id" class="form-control">
                                <option value="">No Class</option>
                                {% for cls in classes %}
                                <option value="{{ cls.id }}" {% if student.class_section_id==cls.id %}selected{% endif
                                    %}>{{ cls.display_name }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Status</label>
                            <select name="status" class="form-control">
                                {% for s in ['active','inactive','transferred','graduated'] %}
                                <option value="{{ s }}" {% if student.status==s %}selected{% endif %}>{{ s|capitalize }}
                                </option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Update Photo (optional)</label>
                            <input type="file" name="photo" class="form-control" accept="image/*">
                        </div>
                        {% if student.photo %}
                        <div style="margin-top:8px"><img src="{{ url_for('static', filename=student.photo) }}"
                                style="width:80px;height:80px;border-radius:50%;object-fit:cover;border:3px solid var(--primary)"
                                alt="Current photo"></div>
                        {% endif %}
                    </div>
                </div>
                <div class="card">
                    <div class="card-body">
                        <button type="submit" class="btn btn-primary w-100" style="justify-content:center">üíæ Save
                            Changes</button>
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>
{% endblock %}